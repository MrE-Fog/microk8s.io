{% extends "base_layout.html" %}

{% block title %}MicroK8s - {{ document.title }} {% endblock %}

{% block content %}

{% macro create_navigation(nav_items, expandable=False) %}
  <ul class="p-side-navigation__list">
    {% for element in nav_items %}
    <li class="p-side-navigation__item">
      {% if element.navlink_href %}
        <a class="p-side-navigation__link" href="{{ element.navlink_href }}" 
          {% if element.is_active and element.navlink_fragment == "" %}aria-current="page"{% endif %}>
          {{ element.navlink_text }}</a>
      {% else %}
        <span class="p-side-navigation__text">{{ element.navlink_text }}</span>
      {% endif %}

      {% if expandable %}
        {% if element.children and (element.is_active or element.has_active_child) %}
          {{ create_navigation(element.children, True) }}
        {% endif %}
      {% else %}
        {% if element.children %}
          {{ create_navigation(element.children, False) }}
        {% endif %}
      {% endif %}
    </li>
    {% endfor %}
  </ul>
{% endmacro %}

<section id="search-docs" class="p-strip--light is-shallow">
  <div class="row">
    <form class="p-search-box u-no-margin--bottom" action="/docs/search">
      <input type="search" class="p-search-box__input" name="q" {% if query %}value="{{ query }}"{% endif %} placeholder="Search documentation" required/>
      <button type="submit" class="p-search-box__button" alt="search"><i class="p-icon--search">Search</i></button>
    </form>
  </div>
</section>

<div class="p-strip is-shallow">
  <div class="row">
    <aside class="col-3">
      <div class="p-side-navigation" id="drawer">
        <a href="#drawer" class="p-side-navigation__toggle js-drawer-toggle" aria-controls="drawer">
          Toggle side navigation
        </a>
        <div class="p-side-navigation__overlay js-drawer-toggle" aria-controls="drawer"></div>
        <div class="p-side-navigation__drawer">
          <div class="p-side-navigation__drawer-header">
            <a href="#" class="p-side-navigation__toggle--in-drawer js-drawer-toggle" aria-controls="drawer">
              Toggle side navigation
            </a>
          </div>
          {% for nav_group in navigation.nav_items %}
            {% if nav_group.navlink_text %}
              {% if nav_group.navlink_href %}
                <h3 class="p-side-navigation__heading--linked">
                  <a class="p-side-navigation__link" href="{{ nav_group.navlink_href }}" {% if nav_group.is_active and nav_group.navlink_fragment == "" %}aria-current="page"{% endif %}>
                    {{ nav_group.navlink_text }}
                  </a>
                </h3>
              {% else %}
                <h3 class="p-side-navigation__heading">{{ nav_group.navlink_text }}</h3>
              {% endif %}
              {#
                Use `create_navigation(nav_group.children)` for a default, fully expanded navigation.
                Use `create_navigation(nav_group.children, expandable=True)` for the nested nav levels to expand only when parent page is active.
              #}
              {{ create_navigation(nav_group.children, expandable=True) }} 
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </aside>

    <main class="col-9">
      {% if document.title %}
      <div class="p-strip is-shallow is-bordered u-no-padding--top">
        <h1 class="u-no-margin--bottom">{{ document.title }}</h1>
      </div>
      {% endif %}
      <div class="p-strip is-shallow" style="overflow: visible;">
      {{ document.body_html | safe }}
      </div>

			<div class="p-strip is-shallow">
				<div class="p-notification--information">
					<div class="p-notification__content">
						<p class="p-notification__message">Last updated {{ document.updated }}. <a href="{{ forum_url }}{{ document.topic_path }}">Help improve this document in the forum</a>.</p>
          </div>
				</div>
			</div>
    </main>
  </div>
</div>

{% endblock %}
